<div *ngFor="let producto of products" class="flex flex-col bg-white rounded-lg shadow-lg p-5 relative">
  <!--Aca tendria que estar en el src item.producto.image_url-->
  <img src="https://img.freepik.com/psd-premium/pila-patatas-fritas-crujientes_1234317-2146.jpg?w=740" alt="Producto"
    class="object-cover w-full h-40 mb-4" />
  <h3 class="text-lg font-semibold mb-2 text-gray-800">{{ producto.name }}</h3>

  <div class="flex justify-between items-center">
    <span class="text-xl font-bold text-orange-600">
      ${{ producto.price * 100 }}
    </span>
    <!-- Botón "+" solo aparece en modo "user" -->

    <button *ngIf="modo === 'user'" (click)="openCard(producto.id)" title="Add New"
      class="group cursor-pointer outline-none hover:rotate-90 duration-300">
      <svg xmlns="http://www.w3.org/2000/svg" width="50px" height="50px" viewBox="0 0 24 24"
        class="stroke-red-500 fill-none group-hover:fill-white-600 group-active:stroke-green-200 group-active:fill-orange-600 group-active:duration-0 duration-300">
        <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z"
          stroke-width="1.5"></path>
        <path d="M8 12H16" stroke-width="1.5"></path>
        <path d="M12 16V8" stroke-width="1.5"></path>
      </svg>
    </button>
  </div>

  <!-- Card flotante para detalles del producto -->

  <div *ngIf="productoSeleccionado.id === producto.id"
    class="fixed inset-10 bg-white shadow-lg rounded-lg p-6 flex flex-col z-50 overflow-y-auto mx-auto border border-gray-200"
    (clickOutside)="closeCard()">
    <div>
      <h3 class="text-xl font-bold mb-2 text-gray-800">{{ producto.name }}</h3>
    </div>
    <div class="modal-body">
      <!-- Sección de descripción del Producto: Lado IZQUIERDO -->
      <div class="modal-section shadow-lg left-section">
        <div class="p-6">
          <h3 class="text-xl font-semibold text-gray-900 dark:text-white">Detalles del Producto</h3>
          <h2 class="font-semibold text-gray-900 dark:text-white">{{ producto.name }}</h2>
          <img class="border-imag" src="{{ producto.image_url }}" alt="">
          <p class="text-gray-700 font-semibold mb-4">{{ producto.description }}</p>
        </div>
      </div>
      <div class="modal-section shadow-lg right-section">
        <!-- Sección de personalización: Lado DERECHO -->
        <p class="text-gray-700 font-semibold mb-4">Sección de personalización</p>

        <!-- Personalización por categoria -->

        <!-- Categoria Ofertas -->
        @if (producto.category_id == 1) {

        }
        <!-- Categoria Hamburguesas -->
        @if (producto.category_id == 2) {
        <div *ngFor="let opcion of opcionesAHamburguresa" class="checkbox-wrapper">
          <input type="checkbox" class="check" [id]="opcion.id" [(ngModel)]="opcion.checked"
            (ngModelChange)="actualizarOpcionesSeleccionadas(opcion)">
          <label [for]="opcion.id" class="label flex items-center">
            <svg width="45" height="45" viewBox="0 0 95 95">
              <rect x="30" y="20" width="50" height="50" stroke="black" fill="none"></rect>
              <g transform="translate(0,-952.36222)">
                <path d="m 56,963 c -102,122 6,9 7,9 17,-5 -66,69 -38,52 122,-77 -7,14 18,4 29,-11 45,-43 23,-4"
                  stroke="black" stroke-width="3" fill="none" class="path1"></path>
              </g>
            </svg>
            <div class="flex-container">
              <span class="font-semibold">{{ opcion.texto }}</span>
              <span class="font-semibold">Precio Extra: {{ opcion.precioExtra }}</span>
            </div>
          </label>
        </div>
        <div>
          <p> Total: {{calcularTotal()}}</p>
        </div>
        }
        <!-- Categoria Papas fritas -->
        @if (producto.category_id == 3) {
        <div class="py-4"></div>
        <div class="flex-row">
          <span class="font-semibold py-3">Tamaños de porción disponibles:</span>
          <div class="flex btn-group py-5">
            <button class="btn left" type="button" (click)="seleccionarTamano('pequeno')">Pequeño</button>
            <button class="btn middle" type="button" (click)="seleccionarTamano('mediano')">Mediano</button>
            <button class="btn right" type="button" (click)="seleccionarTamano('grande')">Grande</button>
          </div>
        </div>
        }
        <!-- Categoria Pizzas -->
        @if (producto.category_id == 4) {
        <div *ngFor="let opcion of opcionesAPizzas" class="checkbox-wrapper">
          <input type="checkbox" class="check" [id]="opcion.id" [(ngModel)]="opcion.checked"
            (ngModelChange)="actualizarOpcionesSeleccionadas(opcion)">
          <label [for]="opcion.id" class="label flex items-center">
            <svg width="45" height="45" viewBox="0 0 95 95">
              <rect x="30" y="20" width="50" height="50" stroke="black" fill="none"></rect>
              <g transform="translate(0,-952.36222)">
                <path d="m 56,963 c -102,122 6,9 7,9 17,-5 -66,69 -38,52 122,-77 -7,14 18,4 29,-11 45,-43 23,-4"
                  stroke="black" stroke-width="3" fill="none" class="path1"></path>
              </g>
            </svg>
            <div class="flex-container">
              <span class="font-semibold">{{ opcion.texto }}</span>
              <span class="font-semibold">Precio Extra: {{ opcion.precioExtra }}</span>
            </div>
          </label>
        </div>
        <div class="py-4">
          <div class="flex-row">
            <span class="font-semibold py-3">Tamaños disponibles:</span>
            <div class="flex btn-group py-5">
              <button class="btn left" type="button" (click)="seleccionarTamano('pequenoPizza')">Pequeño</button>
              <button class="btn middle" type="button" (click)="seleccionarTamano('medianoPizza')">Mediano</button>
              <button class="btn right" type="button" (click)="seleccionarTamano('familiarPizza')">Grande</button>
            </div>
          </div>
        </div>
        }
        <!-- Categoria Postres -->
        @if (producto.category_id == 5) {
        <div *ngFor="let opcion of opcionesAPostres" class="checkbox-wrapper">
          <input type="checkbox" class="check" [id]="opcion.id" [(ngModel)]="opcion.checked"
            (ngModelChange)="actualizarOpcionesSeleccionadas(opcion)">
          <label [for]="opcion.id" class="label flex items-center">
            <svg width="45" height="45" viewBox="0 0 95 95">
              <rect x="30" y="20" width="50" height="50" stroke="black" fill="none"></rect>
              <g transform="translate(0,-952.36222)">
                <path d="m 56,963 c -102,122 6,9 7,9 17,-5 -66,69 -38,52 122,-77 -7,14 18,4 29,-11 45,-43 23,-4"
                  stroke="black" stroke-width="3" fill="none" class="path1"></path>
              </g>
            </svg>
            <div class="flex-container">
              <span class="font-semibold">{{ opcion.texto }}</span>
              <span class="font-semibold">Precio Extra: {{ opcion.precioExtra }}</span>
            </div>
          </label>
        </div>
        <div class="py-4"></div>
        <div class="flex-row">
          <span class="font-semibold py-3">Tamaños de porción disponibles:</span>
          <div class="flex btn-group py-5">
            <button class="btn left" type="button" (click)="seleccionarTamano('pequenoPostre')">Pequeño</button>
            <button class="btn middle" type="button" (click)="seleccionarTamano('medianoPostre')">Mediano</button>
            <button class="btn right" type="button" (click)="seleccionarTamano('grandePostre')">Grande</button>
          </div>
        </div>
        }
        <!-- Categoria Bebidas -->
        @if (producto.category_id == 6) {
        <span class="justify-center font-semibold py-3">Tamaños disponibles:</span>
        <div class="flex btn-group py-5">
          <button class="btn left" type="button" (click)="seleccionarTamano('pequenoBebida')">Pequeño</button>
          <button class="btn middle" type="button" (click)="seleccionarTamano('medianoBebida')">Mediano</button>
          <button class="btn right" type="button" (click)="seleccionarTamano('grandeBebida')">Grande</button>
        </div>
        }
      </div>
    </div>
    <button
      class="mt-auto px-4 py-2 bg-orange-500 text-white rounded hover:bg-orange-600 transition-colors duration-300"
      (click)="agregarProducto(producto)">
      Agregar al pedido
    </button>
    <button class="absolute top-2 right-2 text-gray-600 hover:text-gray-800" (click)="closeCard()">
      ✕
    </button>
  </div>
</div>